<%- include('../includes/header.ejs') %>

<body>
  <%- include('../includes/headbody.ejs') %>


  <div style="margin-top: 100px;">
        <div class="container">

                <%
                      if(products.length > 0)
                      {
                  %>
                <table class="table text-center">
                  <thead class="thead-dark">
                    <tr>
                      <th scope="col">#</th>
                      <th scope="col">Title</th>
                      <th scope="col">Price</th>
                      <th scope="col">Quanity</th>
                    </tr>
                  </thead>
                  <tbody>
                    <%
                          products.forEach((product, index)=>{
                  %>
                    <tr>
                      <th scope="row"><%- index + 1;%></th>
                      <td><%- product.productId.title;%></td>
                      <td><%- product.productId.price;%>$</td>
                      <td><%- product.quantity;%></td>
                    </tr>       
                    <%
                    })
                  %>
                  &nbsp;
                  <div class="form-group">
                    <h2>Total: <%- totalPrice; %>$</h2>
                  </div>
                &nbsp;
                <form action="/create-order" method="POST">
                  <button type="submit">orders</button>
                </form>
                &nbsp;
                  <div style="padding: 10px 0px; float: right">
                        <form action="/create-order" method="POST">
                            <script
                                src="https://checkout.stripe.com/checkout.js" 
                                class="stripe-button"
                                data-key="pk_test_yCJeL0uYHSkxLHYbqw3KCjVn00uk96s9FT"
                                data-amount="<%- totalPrice * 100; %>"
                                data-name="Demo Site"
                                data-locale="auto",
                                data-currency="usd">
                            </script>
                        </form>

          <!-- <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal"> 
            Checkout
          </button>

          <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Checkout</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <form action="/create-order" method="post" id="payment-form">
              <div class="modal-body">
                <div class="card-errors"></div>
                          
                <div class="form-row">
                  <label>
                    <span>Card number</span>
                    <input type="text" size="20" data-stripe="number">
                  </label>
                </div>
              
                <div class="form-row">
                  <label>
                    <span>Expiration (MM/YY)</span>
                    <input type="text" size="2" data-stripe="exp_month">
                  </label>
                  <span> / </span>
                  <input type="text" size="2" data-stripe="exp_year">
                </div>
              
                <div class="form-row">
                  <label>
                    <span>CVC</span>
                    <input type="text" size="4" data-stripe="cvc">
                  </label>
                </div>
              
                <div class="form-row">
                  <label>
                    <span>Billing Zip</span>
                    <input type="text" size="6" data-stripe="address_zip">
                  </label>
                </div>
              
              </div>
              <div class="modal-footer">
                <input type="submit" class="submit" value="Submit Payment" class="btn btn-outline-success">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              </div>
              </form>
            </div>
          </div>
        </div>   -->
        
        
        </div>
        </tbody>
      </table>
                <%
                    }
                    else
                    {
                  %>
                <span class="alert alert-danger">No product in cart !</span>
                <%
                    }
                  %>
          
          
              </div>
  </div>
  <!-- <script src="/js/checkout.js"></script> -->
  <%- include('../includes/footer.ejs');%>
  <!-- <script src="https://js.stripe.com/v3/"></script> -->
</body>
</html>